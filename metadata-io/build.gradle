apply plugin: 'java'

configurations {
  enhance
}

dependencies {
  compile project(':entity-registry')
  compile project(':metadata-utils')
  compile project(':metadata-dao-impl:kafka-producer')
  compile project(':metadata-events:mxe-avro-1.7')
  compile project(':metadata-events:mxe-registration')
  compile project(':metadata-events:mxe-utils-avro-1.7')
  compile project(path: ':metadata-models')

  compile externalDependency.lombok
  compile externalDependency.elasticSearchRest
  compile externalDependency.elasticSearchTransport
  compile externalDependency.kafkaClients
  compile externalDependency.gmaEbeanDao
  compile spec.product.pegasus.data
  compile spec.product.pegasus.generator
  compile project(path: ':metadata-models')
  compile project(':metadata-dao-impl:restli-dao')

  compile externalDependency.gmaDaoApi
  compile externalDependency.gmaRestliResources
  compile externalDependency.gmaElasticsearchDao
  enhance externalDependency.ebeanAgent

  implementation gradleApi()
  annotationProcessor externalDependency.lombok
}

project.compileJava {
  doLast {
    ant.taskdef(name: 'ebean', classname: 'io.ebean.enhance.ant.AntEnhanceTask',
        classpath: project.configurations.enhance.asPath)
    ant.ebean(classSource: "${project.buildDir}/classes/java/main", packages: 'com.linkedin.metadata.dao.ebean',
        transformArgs: 'debug=1')
  }
}