[
{
    "proposedSnapshot": {
        "com.linkedin.pegasus2avro.metadata.snapshot.DatasetSnapshot": {
            "urn": "urn:li:dataset:(urn:li:dataPlatform:delta-lake,my-platform.tests/integration/delta_lake/test_data/delta_tables_nested_datatype/table_with_string_and_array,UAT)",
            "aspects": [
                {
                    "com.linkedin.pegasus2avro.common.Status": {
                        "removed": false
                    }
                },
                {
                    "com.linkedin.pegasus2avro.dataset.DatasetProperties": {
                        "customProperties": {
                            "number_of_files": "2",
                            "partition_columns": "[]",
                            "table_creation_time": "1708329075098",
                            "id": "bccc302c-006d-4de9-b572-0c1939e64fc5",
                            "version": "0",
                            "location": "tests/integration/delta_lake/test_data/delta_tables_nested_datatype"
                        },
                        "name": "table_with_string_and_array",
                        "tags": []
                    }
                },
                {
                    "com.linkedin.pegasus2avro.schema.SchemaMetadata": {
                        "schemaName": "table_with_string_and_array",
                        "platform": "urn:li:dataPlatform:delta-lake",
                        "version": 0,
                        "created": {
                            "time": 0,
                            "actor": "urn:li:corpuser:unknown"
                        },
                        "lastModified": {
                            "time": 0,
                            "actor": "urn:li:corpuser:unknown"
                        },
                        "hash": "",
                        "platformSchema": {
                            "com.linkedin.pegasus2avro.schema.OtherSchema": {
                                "rawSchema": ""
                            }
                        },
                        "fields": [
                            {
                                "fieldPath": "[version=2.0].[type=struct].[type=array].[type=struct].data",
                                "nullable": false,
                                "type": {
                                    "type": {
                                        "com.linkedin.pegasus2avro.schema.ArrayType": {
                                            "nestedType": [
                                                "record"
                                            ]
                                        }
                                    }
                                },
                                "nativeDataType": "array<item:string>",
                                "recursive": false,
                                "isPartOfKey": false,
                                "jsonProps": "{\"native_data_type\": \"array<item:string>\"}"
                            },
                            {
                                "fieldPath": "[version=2.0].[type=struct].[type=array].[type=struct].data.[type=string].item",
                                "nullable": true,
                                "type": {
                                    "type": {
                                        "com.linkedin.pegasus2avro.schema.StringType": {}
                                    }
                                },
                                "nativeDataType": "string",
                                "recursive": false,
                                "isPartOfKey": false,
                                "jsonProps": "{\"native_data_type\": \"string\", \"_nullable\": true}"
                            },
                            {
                                "fieldPath": "id",
                                "nullable": true,
                                "description": "{}",
                                "type": {
                                    "type": {
                                        "com.linkedin.pegasus2avro.schema.StringType": {}
                                    }
                                },
                                "nativeDataType": "string",
                                "recursive": false,
                                "isPartOfKey": false,
                                "isPartitioningKey": false
                            }
                        ]
                    }
                }
            ]
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:189046201d696e7810132cfa64dad337",
    "changeType": "UPSERT",
    "aspectName": "containerProperties",
    "aspect": {
        "json": {
            "customProperties": {
                "platform": "delta-lake",
                "instance": "my-platform",
                "env": "UAT",
                "folder_abs_path": "tests"
            },
            "name": "tests"
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:189046201d696e7810132cfa64dad337",
    "changeType": "UPSERT",
    "aspectName": "status",
    "aspect": {
        "json": {
            "removed": false
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:189046201d696e7810132cfa64dad337",
    "changeType": "UPSERT",
    "aspectName": "dataPlatformInstance",
    "aspect": {
        "json": {
            "platform": "urn:li:dataPlatform:delta-lake",
            "instance": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)"
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:189046201d696e7810132cfa64dad337",
    "changeType": "UPSERT",
    "aspectName": "subTypes",
    "aspect": {
        "json": {
            "typeNames": [
                "Folder"
            ]
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:189046201d696e7810132cfa64dad337",
    "changeType": "UPSERT",
    "aspectName": "browsePathsV2",
    "aspect": {
        "json": {
            "path": [
                {
                    "id": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)",
                    "urn": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)"
                }
            ]
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:acf0f3806f475a7397ee745329ef2967",
    "changeType": "UPSERT",
    "aspectName": "containerProperties",
    "aspect": {
        "json": {
            "customProperties": {
                "platform": "delta-lake",
                "instance": "my-platform",
                "env": "UAT",
                "folder_abs_path": "tests/integration"
            },
            "name": "integration"
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:acf0f3806f475a7397ee745329ef2967",
    "changeType": "UPSERT",
    "aspectName": "status",
    "aspect": {
        "json": {
            "removed": false
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:acf0f3806f475a7397ee745329ef2967",
    "changeType": "UPSERT",
    "aspectName": "dataPlatformInstance",
    "aspect": {
        "json": {
            "platform": "urn:li:dataPlatform:delta-lake",
            "instance": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)"
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:acf0f3806f475a7397ee745329ef2967",
    "changeType": "UPSERT",
    "aspectName": "subTypes",
    "aspect": {
        "json": {
            "typeNames": [
                "Folder"
            ]
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:acf0f3806f475a7397ee745329ef2967",
    "changeType": "UPSERT",
    "aspectName": "container",
    "aspect": {
        "json": {
            "container": "urn:li:container:189046201d696e7810132cfa64dad337"
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:acf0f3806f475a7397ee745329ef2967",
    "changeType": "UPSERT",
    "aspectName": "browsePathsV2",
    "aspect": {
        "json": {
            "path": [
                {
                    "id": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)",
                    "urn": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)"
                },
                {
                    "id": "urn:li:container:189046201d696e7810132cfa64dad337",
                    "urn": "urn:li:container:189046201d696e7810132cfa64dad337"
                }
            ]
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:1876d057d0ee364677b85427342e2c82",
    "changeType": "UPSERT",
    "aspectName": "containerProperties",
    "aspect": {
        "json": {
            "customProperties": {
                "platform": "delta-lake",
                "instance": "my-platform",
                "env": "UAT",
                "folder_abs_path": "tests/integration/delta_lake"
            },
            "name": "delta_lake"
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:1876d057d0ee364677b85427342e2c82",
    "changeType": "UPSERT",
    "aspectName": "status",
    "aspect": {
        "json": {
            "removed": false
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:1876d057d0ee364677b85427342e2c82",
    "changeType": "UPSERT",
    "aspectName": "dataPlatformInstance",
    "aspect": {
        "json": {
            "platform": "urn:li:dataPlatform:delta-lake",
            "instance": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)"
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:1876d057d0ee364677b85427342e2c82",
    "changeType": "UPSERT",
    "aspectName": "subTypes",
    "aspect": {
        "json": {
            "typeNames": [
                "Folder"
            ]
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:1876d057d0ee364677b85427342e2c82",
    "changeType": "UPSERT",
    "aspectName": "container",
    "aspect": {
        "json": {
            "container": "urn:li:container:acf0f3806f475a7397ee745329ef2967"
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:1876d057d0ee364677b85427342e2c82",
    "changeType": "UPSERT",
    "aspectName": "browsePathsV2",
    "aspect": {
        "json": {
            "path": [
                {
                    "id": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)",
                    "urn": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)"
                },
                {
                    "id": "urn:li:container:189046201d696e7810132cfa64dad337",
                    "urn": "urn:li:container:189046201d696e7810132cfa64dad337"
                },
                {
                    "id": "urn:li:container:acf0f3806f475a7397ee745329ef2967",
                    "urn": "urn:li:container:acf0f3806f475a7397ee745329ef2967"
                }
            ]
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:7888b6dab77b7e77709699c9a1b81aa4",
    "changeType": "UPSERT",
    "aspectName": "containerProperties",
    "aspect": {
        "json": {
            "customProperties": {
                "platform": "delta-lake",
                "instance": "my-platform",
                "env": "UAT",
                "folder_abs_path": "tests/integration/delta_lake/test_data"
            },
            "name": "test_data"
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:7888b6dab77b7e77709699c9a1b81aa4",
    "changeType": "UPSERT",
    "aspectName": "status",
    "aspect": {
        "json": {
            "removed": false
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:7888b6dab77b7e77709699c9a1b81aa4",
    "changeType": "UPSERT",
    "aspectName": "dataPlatformInstance",
    "aspect": {
        "json": {
            "platform": "urn:li:dataPlatform:delta-lake",
            "instance": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)"
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:7888b6dab77b7e77709699c9a1b81aa4",
    "changeType": "UPSERT",
    "aspectName": "subTypes",
    "aspect": {
        "json": {
            "typeNames": [
                "Folder"
            ]
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:7888b6dab77b7e77709699c9a1b81aa4",
    "changeType": "UPSERT",
    "aspectName": "container",
    "aspect": {
        "json": {
            "container": "urn:li:container:1876d057d0ee364677b85427342e2c82"
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:7888b6dab77b7e77709699c9a1b81aa4",
    "changeType": "UPSERT",
    "aspectName": "browsePathsV2",
    "aspect": {
        "json": {
            "path": [
                {
                    "id": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)",
                    "urn": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)"
                },
                {
                    "id": "urn:li:container:189046201d696e7810132cfa64dad337",
                    "urn": "urn:li:container:189046201d696e7810132cfa64dad337"
                },
                {
                    "id": "urn:li:container:acf0f3806f475a7397ee745329ef2967",
                    "urn": "urn:li:container:acf0f3806f475a7397ee745329ef2967"
                },
                {
                    "id": "urn:li:container:1876d057d0ee364677b85427342e2c82",
                    "urn": "urn:li:container:1876d057d0ee364677b85427342e2c82"
                }
            ]
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:401e53437a2ce6094ab3021cb32919d9",
    "changeType": "UPSERT",
    "aspectName": "containerProperties",
    "aspect": {
        "json": {
            "customProperties": {
                "platform": "delta-lake",
                "instance": "my-platform",
                "env": "UAT",
                "folder_abs_path": "tests/integration/delta_lake/test_data/delta_tables_nested_datatype"
            },
            "name": "delta_tables_nested_datatype"
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:401e53437a2ce6094ab3021cb32919d9",
    "changeType": "UPSERT",
    "aspectName": "status",
    "aspect": {
        "json": {
            "removed": false
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:401e53437a2ce6094ab3021cb32919d9",
    "changeType": "UPSERT",
    "aspectName": "dataPlatformInstance",
    "aspect": {
        "json": {
            "platform": "urn:li:dataPlatform:delta-lake",
            "instance": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)"
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:401e53437a2ce6094ab3021cb32919d9",
    "changeType": "UPSERT",
    "aspectName": "subTypes",
    "aspect": {
        "json": {
            "typeNames": [
                "Folder"
            ]
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:401e53437a2ce6094ab3021cb32919d9",
    "changeType": "UPSERT",
    "aspectName": "container",
    "aspect": {
        "json": {
            "container": "urn:li:container:7888b6dab77b7e77709699c9a1b81aa4"
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:401e53437a2ce6094ab3021cb32919d9",
    "changeType": "UPSERT",
    "aspectName": "browsePathsV2",
    "aspect": {
        "json": {
            "path": [
                {
                    "id": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)",
                    "urn": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)"
                },
                {
                    "id": "urn:li:container:189046201d696e7810132cfa64dad337",
                    "urn": "urn:li:container:189046201d696e7810132cfa64dad337"
                },
                {
                    "id": "urn:li:container:acf0f3806f475a7397ee745329ef2967",
                    "urn": "urn:li:container:acf0f3806f475a7397ee745329ef2967"
                },
                {
                    "id": "urn:li:container:1876d057d0ee364677b85427342e2c82",
                    "urn": "urn:li:container:1876d057d0ee364677b85427342e2c82"
                },
                {
                    "id": "urn:li:container:7888b6dab77b7e77709699c9a1b81aa4",
                    "urn": "urn:li:container:7888b6dab77b7e77709699c9a1b81aa4"
                }
            ]
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "dataset",
    "entityUrn": "urn:li:dataset:(urn:li:dataPlatform:delta-lake,my-platform.tests/integration/delta_lake/test_data/delta_tables_nested_datatype/table_with_string_and_array,UAT)",
    "changeType": "UPSERT",
    "aspectName": "container",
    "aspect": {
        "json": {
            "container": "urn:li:container:401e53437a2ce6094ab3021cb32919d9"
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "dataset",
    "entityUrn": "urn:li:dataset:(urn:li:dataPlatform:delta-lake,my-platform.tests/integration/delta_lake/test_data/delta_tables_nested_datatype/table_with_string_and_array,UAT)",
    "changeType": "UPSERT",
    "aspectName": "operation",
    "aspect": {
        "json": {
            "timestampMillis": 1615443388097,
            "partitionSpec": {
                "type": "FULL_TABLE",
                "partition": "FULL_TABLE_SNAPSHOT"
            },
            "operationType": "CUSTOM",
            "customOperationType": "WRITE",
            "customProperties": {
                "engineInfo": "Apache-Spark/3.5.0 Delta-Lake/3.1.0",
                "isBlindAppend": "False",
                "isolationLevel": "Serializable",
                "operationMetrics_numFiles": "3",
                "operationMetrics_numOutputBytes": "2027",
                "operationMetrics_numOutputRows": "2",
                "operationParameters_mode": "Overwrite",
                "operationParameters_partitionBy": "[]",
                "txnId": "c1497bc8-403a-451f-b651-adeaad02a74d",
                "version": "0"
            },
            "lastUpdatedTimestamp": 1708329078869
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "dataset",
    "entityUrn": "urn:li:dataset:(urn:li:dataPlatform:delta-lake,my-platform.tests/integration/delta_lake/test_data/delta_tables_nested_datatype/table_with_string_and_array,UAT)",
    "changeType": "UPSERT",
    "aspectName": "browsePathsV2",
    "aspect": {
        "json": {
            "path": [
                {
                    "id": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)",
                    "urn": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)"
                },
                {
                    "id": "urn:li:container:189046201d696e7810132cfa64dad337",
                    "urn": "urn:li:container:189046201d696e7810132cfa64dad337"
                },
                {
                    "id": "urn:li:container:acf0f3806f475a7397ee745329ef2967",
                    "urn": "urn:li:container:acf0f3806f475a7397ee745329ef2967"
                },
                {
                    "id": "urn:li:container:1876d057d0ee364677b85427342e2c82",
                    "urn": "urn:li:container:1876d057d0ee364677b85427342e2c82"
                },
                {
                    "id": "urn:li:container:7888b6dab77b7e77709699c9a1b81aa4",
                    "urn": "urn:li:container:7888b6dab77b7e77709699c9a1b81aa4"
                },
                {
                    "id": "urn:li:container:401e53437a2ce6094ab3021cb32919d9",
                    "urn": "urn:li:container:401e53437a2ce6094ab3021cb32919d9"
                }
            ]
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "proposedSnapshot": {
        "com.linkedin.pegasus2avro.metadata.snapshot.DatasetSnapshot": {
            "urn": "urn:li:dataset:(urn:li:dataPlatform:delta-lake,my-platform.tests/integration/delta_lake/test_data/delta_tables_nested_datatype/table_with_string_and_array_of_struct,UAT)",
            "aspects": [
                {
                    "com.linkedin.pegasus2avro.common.Status": {
                        "removed": false
                    }
                },
                {
                    "com.linkedin.pegasus2avro.dataset.DatasetProperties": {
                        "customProperties": {
                            "number_of_files": "2",
                            "partition_columns": "[]",
                            "table_creation_time": "1708329893422",
                            "id": "6f3b01e4-ae1e-415a-979a-34861346809b",
                            "version": "0",
                            "location": "tests/integration/delta_lake/test_data/delta_tables_nested_datatype"
                        },
                        "name": "table_with_string_and_array_of_struct",
                        "tags": []
                    }
                },
                {
                    "com.linkedin.pegasus2avro.schema.SchemaMetadata": {
                        "schemaName": "table_with_string_and_array_of_struct",
                        "platform": "urn:li:dataPlatform:delta-lake",
                        "version": 0,
                        "created": {
                            "time": 0,
                            "actor": "urn:li:corpuser:unknown"
                        },
                        "lastModified": {
                            "time": 0,
                            "actor": "urn:li:corpuser:unknown"
                        },
                        "hash": "",
                        "platformSchema": {
                            "com.linkedin.pegasus2avro.schema.OtherSchema": {
                                "rawSchema": ""
                            }
                        },
                        "fields": [
                            {
                                "fieldPath": "[version=2.0].[type=struct].[type=array].[type=struct].data",
                                "nullable": false,
                                "type": {
                                    "type": {
                                        "com.linkedin.pegasus2avro.schema.ArrayType": {
                                            "nestedType": [
                                                "record"
                                            ]
                                        }
                                    }
                                },
                                "nativeDataType": "array<item:struct<name:string,value:integer>>",
                                "recursive": false,
                                "isPartOfKey": false,
                                "jsonProps": "{\"native_data_type\": \"array<item:struct<name:string,value:integer>>\"}"
                            },
                            {
                                "fieldPath": "[version=2.0].[type=struct].[type=array].[type=struct].data.[type=struct].item",
                                "nullable": false,
                                "type": {
                                    "type": {
                                        "com.linkedin.pegasus2avro.schema.RecordType": {}
                                    }
                                },
                                "nativeDataType": "struct<name:string,value:integer>",
                                "recursive": false,
                                "isPartOfKey": false,
                                "jsonProps": "{\"native_data_type\": \"struct<name:string,value:integer>\"}"
                            },
                            {
                                "fieldPath": "[version=2.0].[type=struct].[type=array].[type=struct].data.[type=struct].item.[type=int].value",
                                "nullable": true,
                                "type": {
                                    "type": {
                                        "com.linkedin.pegasus2avro.schema.NumberType": {}
                                    }
                                },
                                "nativeDataType": "integer",
                                "recursive": false,
                                "isPartOfKey": false,
                                "jsonProps": "{\"native_data_type\": \"integer\", \"_nullable\": true}"
                            },
                            {
                                "fieldPath": "[version=2.0].[type=struct].[type=array].[type=struct].data.[type=struct].item.[type=string].name",
                                "nullable": true,
                                "type": {
                                    "type": {
                                        "com.linkedin.pegasus2avro.schema.StringType": {}
                                    }
                                },
                                "nativeDataType": "string",
                                "recursive": false,
                                "isPartOfKey": false,
                                "jsonProps": "{\"native_data_type\": \"string\", \"_nullable\": true}"
                            },
                            {
                                "fieldPath": "id",
                                "nullable": true,
                                "description": "{}",
                                "type": {
                                    "type": {
                                        "com.linkedin.pegasus2avro.schema.StringType": {}
                                    }
                                },
                                "nativeDataType": "string",
                                "recursive": false,
                                "isPartOfKey": false,
                                "isPartitioningKey": false
                            }
                        ]
                    }
                }
            ]
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "dataset",
    "entityUrn": "urn:li:dataset:(urn:li:dataPlatform:delta-lake,my-platform.tests/integration/delta_lake/test_data/delta_tables_nested_datatype/table_with_string_and_array_of_struct,UAT)",
    "changeType": "UPSERT",
    "aspectName": "container",
    "aspect": {
        "json": {
            "container": "urn:li:container:401e53437a2ce6094ab3021cb32919d9"
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "dataset",
    "entityUrn": "urn:li:dataset:(urn:li:dataPlatform:delta-lake,my-platform.tests/integration/delta_lake/test_data/delta_tables_nested_datatype/table_with_string_and_array_of_struct,UAT)",
    "changeType": "UPSERT",
    "aspectName": "operation",
    "aspect": {
        "json": {
            "timestampMillis": 1615443388097,
            "partitionSpec": {
                "type": "FULL_TABLE",
                "partition": "FULL_TABLE_SNAPSHOT"
            },
            "operationType": "CUSTOM",
            "customOperationType": "WRITE",
            "customProperties": {
                "engineInfo": "Apache-Spark/3.5.0 Delta-Lake/3.1.0",
                "isBlindAppend": "False",
                "isolationLevel": "Serializable",
                "operationMetrics_numFiles": "3",
                "operationMetrics_numOutputBytes": "2943",
                "operationMetrics_numOutputRows": "2",
                "operationParameters_mode": "Overwrite",
                "operationParameters_partitionBy": "[]",
                "txnId": "dd7ddb85-1b3a-4f18-bd8f-1466adfe66b0",
                "version": "0"
            },
            "lastUpdatedTimestamp": 1708329897384
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "dataset",
    "entityUrn": "urn:li:dataset:(urn:li:dataPlatform:delta-lake,my-platform.tests/integration/delta_lake/test_data/delta_tables_nested_datatype/table_with_string_and_array_of_struct,UAT)",
    "changeType": "UPSERT",
    "aspectName": "browsePathsV2",
    "aspect": {
        "json": {
            "path": [
                {
                    "id": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)",
                    "urn": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)"
                },
                {
                    "id": "urn:li:container:189046201d696e7810132cfa64dad337",
                    "urn": "urn:li:container:189046201d696e7810132cfa64dad337"
                },
                {
                    "id": "urn:li:container:acf0f3806f475a7397ee745329ef2967",
                    "urn": "urn:li:container:acf0f3806f475a7397ee745329ef2967"
                },
                {
                    "id": "urn:li:container:1876d057d0ee364677b85427342e2c82",
                    "urn": "urn:li:container:1876d057d0ee364677b85427342e2c82"
                },
                {
                    "id": "urn:li:container:7888b6dab77b7e77709699c9a1b81aa4",
                    "urn": "urn:li:container:7888b6dab77b7e77709699c9a1b81aa4"
                },
                {
                    "id": "urn:li:container:401e53437a2ce6094ab3021cb32919d9",
                    "urn": "urn:li:container:401e53437a2ce6094ab3021cb32919d9"
                }
            ]
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "proposedSnapshot": {
        "com.linkedin.pegasus2avro.metadata.snapshot.DatasetSnapshot": {
            "urn": "urn:li:dataset:(urn:li:dataPlatform:delta-lake,my-platform.tests/integration/delta_lake/test_data/delta_tables_nested_datatype/table_with_string_and_nested_array_of_numbers,UAT)",
            "aspects": [
                {
                    "com.linkedin.pegasus2avro.common.Status": {
                        "removed": false
                    }
                },
                {
                    "com.linkedin.pegasus2avro.dataset.DatasetProperties": {
                        "customProperties": {
                            "number_of_files": "2",
                            "partition_columns": "[]",
                            "table_creation_time": "1708330174792",
                            "id": "9b656138-6370-412a-826b-4f20e659d5c2",
                            "version": "0",
                            "location": "tests/integration/delta_lake/test_data/delta_tables_nested_datatype"
                        },
                        "name": "table_with_string_and_nested_array_of_numbers",
                        "tags": []
                    }
                },
                {
                    "com.linkedin.pegasus2avro.schema.SchemaMetadata": {
                        "schemaName": "table_with_string_and_nested_array_of_numbers",
                        "platform": "urn:li:dataPlatform:delta-lake",
                        "version": 0,
                        "created": {
                            "time": 0,
                            "actor": "urn:li:corpuser:unknown"
                        },
                        "lastModified": {
                            "time": 0,
                            "actor": "urn:li:corpuser:unknown"
                        },
                        "hash": "",
                        "platformSchema": {
                            "com.linkedin.pegasus2avro.schema.OtherSchema": {
                                "rawSchema": ""
                            }
                        },
                        "fields": [
                            {
                                "fieldPath": "data",
                                "nullable": false,
                                "type": {
                                    "type": {
                                        "com.linkedin.pegasus2avro.schema.NullType": {}
                                    }
                                },
                                "nativeDataType": "array<item:array<item:array<item:long>>>>",
                                "recursive": false,
                                "isPartOfKey": false
                            },
                            {
                                "fieldPath": "id",
                                "nullable": true,
                                "description": "{}",
                                "type": {
                                    "type": {
                                        "com.linkedin.pegasus2avro.schema.StringType": {}
                                    }
                                },
                                "nativeDataType": "string",
                                "recursive": false,
                                "isPartOfKey": false,
                                "isPartitioningKey": false
                            }
                        ]
                    }
                }
            ]
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "dataset",
    "entityUrn": "urn:li:dataset:(urn:li:dataPlatform:delta-lake,my-platform.tests/integration/delta_lake/test_data/delta_tables_nested_datatype/table_with_string_and_nested_array_of_numbers,UAT)",
    "changeType": "UPSERT",
    "aspectName": "container",
    "aspect": {
        "json": {
            "container": "urn:li:container:401e53437a2ce6094ab3021cb32919d9"
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "dataset",
    "entityUrn": "urn:li:dataset:(urn:li:dataPlatform:delta-lake,my-platform.tests/integration/delta_lake/test_data/delta_tables_nested_datatype/table_with_string_and_nested_array_of_numbers,UAT)",
    "changeType": "UPSERT",
    "aspectName": "operation",
    "aspect": {
        "json": {
            "timestampMillis": 1615443388097,
            "partitionSpec": {
                "type": "FULL_TABLE",
                "partition": "FULL_TABLE_SNAPSHOT"
            },
            "operationType": "CUSTOM",
            "customOperationType": "WRITE",
            "customProperties": {
                "engineInfo": "Apache-Spark/3.5.0 Delta-Lake/3.1.0",
                "isBlindAppend": "False",
                "isolationLevel": "Serializable",
                "operationMetrics_numFiles": "3",
                "operationMetrics_numOutputBytes": "2773",
                "operationMetrics_numOutputRows": "2",
                "operationParameters_mode": "Overwrite",
                "operationParameters_partitionBy": "[]",
                "txnId": "96c8e2d9-55f7-416d-84de-55d01936e58e",
                "version": "0"
            },
            "lastUpdatedTimestamp": 1708330178404
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "dataset",
    "entityUrn": "urn:li:dataset:(urn:li:dataPlatform:delta-lake,my-platform.tests/integration/delta_lake/test_data/delta_tables_nested_datatype/table_with_string_and_nested_array_of_numbers,UAT)",
    "changeType": "UPSERT",
    "aspectName": "browsePathsV2",
    "aspect": {
        "json": {
            "path": [
                {
                    "id": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)",
                    "urn": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)"
                },
                {
                    "id": "urn:li:container:189046201d696e7810132cfa64dad337",
                    "urn": "urn:li:container:189046201d696e7810132cfa64dad337"
                },
                {
                    "id": "urn:li:container:acf0f3806f475a7397ee745329ef2967",
                    "urn": "urn:li:container:acf0f3806f475a7397ee745329ef2967"
                },
                {
                    "id": "urn:li:container:1876d057d0ee364677b85427342e2c82",
                    "urn": "urn:li:container:1876d057d0ee364677b85427342e2c82"
                },
                {
                    "id": "urn:li:container:7888b6dab77b7e77709699c9a1b81aa4",
                    "urn": "urn:li:container:7888b6dab77b7e77709699c9a1b81aa4"
                },
                {
                    "id": "urn:li:container:401e53437a2ce6094ab3021cb32919d9",
                    "urn": "urn:li:container:401e53437a2ce6094ab3021cb32919d9"
                }
            ]
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:189046201d696e7810132cfa64dad337",
    "changeType": "UPSERT",
    "aspectName": "browsePathsV2",
    "aspect": {
        "json": {
            "path": [
                {
                    "id": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)",
                    "urn": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)"
                }
            ]
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:acf0f3806f475a7397ee745329ef2967",
    "changeType": "UPSERT",
    "aspectName": "browsePathsV2",
    "aspect": {
        "json": {
            "path": [
                {
                    "id": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)",
                    "urn": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)"
                },
                {
                    "id": "urn:li:container:189046201d696e7810132cfa64dad337",
                    "urn": "urn:li:container:189046201d696e7810132cfa64dad337"
                }
            ]
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:1876d057d0ee364677b85427342e2c82",
    "changeType": "UPSERT",
    "aspectName": "browsePathsV2",
    "aspect": {
        "json": {
            "path": [
                {
                    "id": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)",
                    "urn": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)"
                },
                {
                    "id": "urn:li:container:189046201d696e7810132cfa64dad337",
                    "urn": "urn:li:container:189046201d696e7810132cfa64dad337"
                },
                {
                    "id": "urn:li:container:acf0f3806f475a7397ee745329ef2967",
                    "urn": "urn:li:container:acf0f3806f475a7397ee745329ef2967"
                }
            ]
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:7888b6dab77b7e77709699c9a1b81aa4",
    "changeType": "UPSERT",
    "aspectName": "browsePathsV2",
    "aspect": {
        "json": {
            "path": [
                {
                    "id": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)",
                    "urn": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)"
                },
                {
                    "id": "urn:li:container:189046201d696e7810132cfa64dad337",
                    "urn": "urn:li:container:189046201d696e7810132cfa64dad337"
                },
                {
                    "id": "urn:li:container:acf0f3806f475a7397ee745329ef2967",
                    "urn": "urn:li:container:acf0f3806f475a7397ee745329ef2967"
                },
                {
                    "id": "urn:li:container:1876d057d0ee364677b85427342e2c82",
                    "urn": "urn:li:container:1876d057d0ee364677b85427342e2c82"
                }
            ]
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "container",
    "entityUrn": "urn:li:container:401e53437a2ce6094ab3021cb32919d9",
    "changeType": "UPSERT",
    "aspectName": "browsePathsV2",
    "aspect": {
        "json": {
            "path": [
                {
                    "id": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)",
                    "urn": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)"
                },
                {
                    "id": "urn:li:container:189046201d696e7810132cfa64dad337",
                    "urn": "urn:li:container:189046201d696e7810132cfa64dad337"
                },
                {
                    "id": "urn:li:container:acf0f3806f475a7397ee745329ef2967",
                    "urn": "urn:li:container:acf0f3806f475a7397ee745329ef2967"
                },
                {
                    "id": "urn:li:container:1876d057d0ee364677b85427342e2c82",
                    "urn": "urn:li:container:1876d057d0ee364677b85427342e2c82"
                },
                {
                    "id": "urn:li:container:7888b6dab77b7e77709699c9a1b81aa4",
                    "urn": "urn:li:container:7888b6dab77b7e77709699c9a1b81aa4"
                }
            ]
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "dataset",
    "entityUrn": "urn:li:dataset:(urn:li:dataPlatform:delta-lake,my-platform.tests/integration/delta_lake/test_data/delta_tables_nested_datatype/table_with_string_and_array,UAT)",
    "changeType": "UPSERT",
    "aspectName": "browsePathsV2",
    "aspect": {
        "json": {
            "path": [
                {
                    "id": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)",
                    "urn": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)"
                },
                {
                    "id": "urn:li:container:189046201d696e7810132cfa64dad337",
                    "urn": "urn:li:container:189046201d696e7810132cfa64dad337"
                },
                {
                    "id": "urn:li:container:acf0f3806f475a7397ee745329ef2967",
                    "urn": "urn:li:container:acf0f3806f475a7397ee745329ef2967"
                },
                {
                    "id": "urn:li:container:1876d057d0ee364677b85427342e2c82",
                    "urn": "urn:li:container:1876d057d0ee364677b85427342e2c82"
                },
                {
                    "id": "urn:li:container:7888b6dab77b7e77709699c9a1b81aa4",
                    "urn": "urn:li:container:7888b6dab77b7e77709699c9a1b81aa4"
                },
                {
                    "id": "urn:li:container:401e53437a2ce6094ab3021cb32919d9",
                    "urn": "urn:li:container:401e53437a2ce6094ab3021cb32919d9"
                }
            ]
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "dataset",
    "entityUrn": "urn:li:dataset:(urn:li:dataPlatform:delta-lake,my-platform.tests/integration/delta_lake/test_data/delta_tables_nested_datatype/table_with_string_and_array_of_struct,UAT)",
    "changeType": "UPSERT",
    "aspectName": "browsePathsV2",
    "aspect": {
        "json": {
            "path": [
                {
                    "id": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)",
                    "urn": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)"
                },
                {
                    "id": "urn:li:container:189046201d696e7810132cfa64dad337",
                    "urn": "urn:li:container:189046201d696e7810132cfa64dad337"
                },
                {
                    "id": "urn:li:container:acf0f3806f475a7397ee745329ef2967",
                    "urn": "urn:li:container:acf0f3806f475a7397ee745329ef2967"
                },
                {
                    "id": "urn:li:container:1876d057d0ee364677b85427342e2c82",
                    "urn": "urn:li:container:1876d057d0ee364677b85427342e2c82"
                },
                {
                    "id": "urn:li:container:7888b6dab77b7e77709699c9a1b81aa4",
                    "urn": "urn:li:container:7888b6dab77b7e77709699c9a1b81aa4"
                },
                {
                    "id": "urn:li:container:401e53437a2ce6094ab3021cb32919d9",
                    "urn": "urn:li:container:401e53437a2ce6094ab3021cb32919d9"
                }
            ]
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
},
{
    "entityType": "dataset",
    "entityUrn": "urn:li:dataset:(urn:li:dataPlatform:delta-lake,my-platform.tests/integration/delta_lake/test_data/delta_tables_nested_datatype/table_with_string_and_nested_array_of_numbers,UAT)",
    "changeType": "UPSERT",
    "aspectName": "browsePathsV2",
    "aspect": {
        "json": {
            "path": [
                {
                    "id": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)",
                    "urn": "urn:li:dataPlatformInstance:(urn:li:dataPlatform:delta-lake,my-platform)"
                },
                {
                    "id": "urn:li:container:189046201d696e7810132cfa64dad337",
                    "urn": "urn:li:container:189046201d696e7810132cfa64dad337"
                },
                {
                    "id": "urn:li:container:acf0f3806f475a7397ee745329ef2967",
                    "urn": "urn:li:container:acf0f3806f475a7397ee745329ef2967"
                },
                {
                    "id": "urn:li:container:1876d057d0ee364677b85427342e2c82",
                    "urn": "urn:li:container:1876d057d0ee364677b85427342e2c82"
                },
                {
                    "id": "urn:li:container:7888b6dab77b7e77709699c9a1b81aa4",
                    "urn": "urn:li:container:7888b6dab77b7e77709699c9a1b81aa4"
                },
                {
                    "id": "urn:li:container:401e53437a2ce6094ab3021cb32919d9",
                    "urn": "urn:li:container:401e53437a2ce6094ab3021cb32919d9"
                }
            ]
        }
    },
    "systemMetadata": {
        "lastObserved": 1615443388097,
        "runId": "tables_with_nested_datatypes.json",
        "lastRunId": "no-run-id-provided"
    }
}
]